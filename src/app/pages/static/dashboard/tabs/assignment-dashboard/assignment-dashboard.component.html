<div class="feed-header-block">
  <h2>Assignments</h2>
</div>
<div *ngIf="authorizeResourceMethod(resourceActions.LIST)">
  <div class="floating-header-button-container">
    <mat-menu #menu="matMenu">
      <mat-form-field class="menu-item" appearance="outline">
        <mat-label>Status</mat-label>
        <mat-select
          [(ngModel)]="submissionStatusFilter"
          (ngModelChange)="fetchAssignments()"
        >
          <mat-option
            *ngFor="let status of exerciseSubmissionStatusOptions"
            [value]="status.value"
          >
            {{ status.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </mat-menu>
    <button
      type="button"
      mat-mini-fab
      [matMenuTriggerFor]="menu"
      aria-label="Filter the Grading"
    >
      <mat-icon>filter_list</mat-icon>
    </button>
  </div>
  <span *ngIf="assignments.length > 0; else feedEmpty">
    <div
      class="scroll-feed"
      infiniteScroll
      [infiniteScrollDistance]="2"
      [infiniteScrollThrottle]="50"
      infiniteScrollContainer=".scroll-feed"
      [fromRoot]="true"
      (scrolled)="onScroll()"
    >
      <div *ngFor="let card of assignments">
        <span class="assignment-feed-card"> </span>
        <mat-card class="assignment-feed-card" (click)="openChapter(card)">
          <button class="card-count" mat-mini-fab color="primary">
            {{ card.pointsScored }} / {{ card.totalPoints }}
          </button>
          <mat-card-header>
            <mat-card-title>{{ card.title }}</mat-card-title>
            <mat-card-subtitle>
              <small
                >{{ card.course }} > {{ card.section }}. Due on
                {{ parseDate(card.dueDate) }}</small
              ></mat-card-subtitle
            >
          </mat-card-header>
          <mat-card-content> </mat-card-content>
          <mat-card-actions>
            <button type="button" class="card-button" mat-icon-button>
              <mat-icon [ngStyle]="{ color: statusIcon(card).iconColor }">{{
                statusIcon(card).icon
              }}</mat-icon>
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
    </div>
  </span>

  <ng-template #feedEmpty>
    <p class="center-title">There are no assignments matching these filters!</p>
  </ng-template>

  <ng-template #loading>
    <app-simple-loading-spinner></app-simple-loading-spinner>
  </ng-template>
</div>
