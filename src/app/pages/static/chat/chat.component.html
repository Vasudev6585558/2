<nz-layout>
  <nz-sider>
    <mat-form-field class="col-lg-12 col-md-12 col-sm-12" appearance="outline">
      <input matInput #searchMember placeholder="Search a member..." />

      <button mat-icon-button matSuffix (click)="clearSearchMember()">
        <mat-icon>{{ query.length ? "close" : "search" }}</mat-icon>
      </button>
      <mat-hint *ngIf="showSearchMemberError" align="start"
        >Enter at least 3 characters</mat-hint
      >
    </mat-form-field>

    <nz-list
      *ngIf="chatMembers.length"
      nzItemLayout="horizontal"
      [nzLoading]="isFetchingChatMembers"
    >
      <p class="search-info-text">Click to start chatting</p>
      <nz-list-item *ngFor="let member of chatMembers">
        <nz-list-item-meta
          (click)="getIntoChat(member)"
          [nzAvatar]="member.avatar"
          [nzDescription]="member.firstName"
        >
        </nz-list-item-meta>
      </nz-list-item>
    </nz-list>

    <mat-selection-list [multiple]="false" *ngFor="let chatItem of chats">
      <mat-list-option
        [ngClass]="
          chat?.id === chatItem?.id ? 'selectedSection' : 'unselectedSection'
        "
        [value]="chatItem.id"
        (click)="onSelectChat(chatItem)"
      >
        {{ getChatNameFromChat(chatItem) }}
      </mat-list-option>
    </mat-selection-list></nz-sider
  >
  <nz-layout>
    <nz-header>{{ chatName }}</nz-header>
    <nz-content>
      <div id="chat-messages" #chatWindow>
        <nz-list nzItemLayout="vertical">
          <nz-list-item *ngFor="let chatMessage of chat.chatmessageSet">
            <mat-card
              [ngClass]="
                ownMessageOrNot(chatMessage) ? 'own-message' : 'others-message'
              "
            >
              <p>
                <img
                  [src]="chatMessage.author?.avatar"
                  class="
                    ant-avatar ant-avatar-circle ant-avatar-image
                    ng-star-inserted
                  "
                />
                {{ chatMessage.author.firstName }}
              </p>
              <p>{{ chatMessage.message }}</p>
              <small class="chat-time-stamp">
                Sent on {{ parseDateTimeMethod(chatMessage.createdAt) }}</small
              >
            </mat-card>
          </nz-list-item>
        </nz-list>
      </div></nz-content
    >
    <nz-footer>
      <mat-form-field *ngIf="chat.id" id="chat-input" appearance="outline">
        <textarea
          matInput
          [(ngModel)]="draft"
          placeholder="Start typing..."
        ></textarea>
        <button
          id="send-button"
          class="nav-button"
          [disabled]="isCreatingNewChatMessage"
          (click)="sendMessage()"
          aria-label="Send Button"
          mat-icon-button
        >
          <mat-icon>send</mat-icon>
        </button>
      </mat-form-field></nz-footer
    >
  </nz-layout>
</nz-layout>
